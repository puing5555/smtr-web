# 2026-02-24

## 투자SNS 차트 작업 (StockChartClient.tsx)

### 문제
- `/stocks/XRP/` 페이지에서 차트가 제대로 안 보임
- lightweight-charts: 캔들 안 보임 (그리드/로고만 보임), autoSize하면 파란 블록
- TradingView embed widget: 높이 제어 불가
- TradingView direct iframe: 높이 OK, 차트 잘 보임 (유저 확인 완료) BUT 커스텀 마커 불가

### 현재 상태
- TradingView iframe → lightweight-charts로 다시 전환 중
- 목표: 시그널 마커를 차트 위에 직접 표시
- CryptoCompare API로 가격 데이터 가져옴 (CORS 문제 없음, API키 불필요)
- 시그널 데이터: zustand store (influencers.ts), XRP 14개 시그널 (코린이 아빠)

### 핵심 파일
- `invest-sns/src/app/(main)/stocks/[symbol]/StockChartClient.tsx` — 수정 중
- Deploy: `npx next build` → `out/*` → `../smtr-web/` → git push

### 해결됨
- **lightweight-charts v5.1.0은 API가 완전히 바뀜** → v4.2.0으로 다운그레이드해서 해결
  - v5: `addSeries(CandlestickSeries)`, `createSeriesMarkers()` — 빌드는 되지만 캔들이 안 그려짐 (silent fail)
  - v4: `addCandlestickSeries()`, `series.setMarkers()` — 정상 동작
- guru_tracker_v24 스타일 도트 마커 적용 완료 (서브에이전트)
  - 원형 도트(12px) + SVG 대시선 + 호버 프리뷰 + 클릭 툴팁
  - 배포 완료, 도트 보이지만 색상 구분/대시선 등 세부 조정 필요할 수 있음

### 교훈
- **lightweight-charts v5 ≠ v4 API** — tree-shaking 때문에 다른 import 필요, 콘솔 에러 없이 silent fail
- npm install로 다운그레이드할 때 `--save` 안 붙여도 됨 (npm v7+ 기본 저장)
