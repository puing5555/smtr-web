# 2026-02-24

## 시그널 리뷰 & 본사이트 동기화 작업

### 문제
- 리뷰사이트(signal-review-v3.html)와 본사이트(smtr-web) 데이터가 동기화 안 됨
- `corinpapa-signals.ts`에 예전 버전 데이터가 들어가 있었음 (종목명 다름, 개수 다름: 원본177 vs 사이트168)
- 리뷰에서 거부한 4건이 본사이트에 그대로 표시됨

### 리뷰사이트
- **유일한 리뷰사이트**: `https://puing5555.github.io/smtr-web/signal-review-v3.html`
- 다른 버전 전부 삭제함 (v1, v2, v3-embedded, v3-final, v4 등)
- 절대 다른 리뷰사이트 만들지 말 것

### Opus 검토 결과 (거부 4건)
1. **비트마인(BMNR) POSITIVE** → ❌ 삭제 (비교 언급 한 문장뿐)
2. **코인베이스(COIN) CONCERN** → ✏️ 수정 유지 (context 정리)
3. **캔톤네트워크(CC) POSITIVE** → ✏️ 수정 유지 (레버리지 경고 분리)
4. **타르(THAR) POSITIVE** → ❌ 삭제 (시그널 수준 아님)

### 동기화 완료
- 원본: `_deduped_signals_8types_dated.json` (177개)
- 수정 후: `_deduped_signals_8types_dated_corrected.json` (175개)
- `corinpapa-signals.ts` 재생성 (175개, 원본 기준)
- Next.js 빌드 완료

### 플로우 확정
1. Claude Sonnet 추출 → 시그널
2. 사람이 리뷰 (승인/거부)
3. **거부된 것만** Opus 검토 → 수정 or 삭제
4. 본사이트 반영

### 빌드 팁
- Next.js 빌드 OOM 문제 → `next.config.ts`에 `experimental: { workerThreads: false, cpus: 2 }` 임시 추가 후 빌드, 완료 후 원복
- PowerShell에서 한글+괄호 있는 node -e 스크립트는 깨짐 → .js 파일로 만들어서 실행할 것
- `Add-Content`는 시스템 인코딩(EUC-KR)으로 쓰므로 한글 깨짐 → node로 UTF-8 쓰기

### 배포 완료
- GitHub Pages 배포 완료 (force push, `.nojekyll` 추가)
- JS 파일 정상 로딩 확인 (200)

### 차트 매핑 확장 (42개 자산)
- `coingecko.ts`의 `COIN_MAPPING`에 42개 자산 전부 매핑
- 크립토: ripple, ethereum, bitcoin, binancecoin, solana, chainlink, monero, worldcoin-wld, pudgy-penguins
- 주식/카테고리: 빈 문자열 (차트 없음)
- `getCoinId(stock, stockName?)` — stockName을 fallback으로 사용
- `useSignalReturns.ts`에서 `getCoinId(signal.stock, signal.stockName)` 호출

### TODO
- [ ] 유저가 하드리프레시 후 사이트 확인 대기 중
- [ ] 리뷰사이트도 Opus 수정결과 반영 필요 (현재 v3.html은 아직 옛 데이터 임베딩)
- [ ] 리뷰사이트에서 "Opus 수정" 버튼 → 거부건만 Opus 검토하는 기능 구현
